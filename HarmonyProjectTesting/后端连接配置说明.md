# 后端连接配置说明

## 问题诊断

前端应用默认连接的是**远程服务器** (`http://42.193.243.96:9999`)，而不是本地后端。

## 解决方案

### 方法1：在应用启动时设置（推荐）

在应用入口文件中设置BASE_URL，连接到本地后端：

```typescript
// 在 EntryAbility.ts 或应用启动时
AppStorage.SetOrCreate('BASE_URL', 'http://localhost:9999')
```

**注意**：
- 如果使用Android模拟器，需要使用 `http://10.0.2.2:9999` 而不是 `localhost`
- 如果使用真机，需要使用电脑的IP地址，例如 `http://192.168.1.100:9999`

### 方法2：修改HttpUtils.ets（临时方案）

直接修改 `SalesNewMaster/entry/src/main/ets/utils/HttpUtils.ets` 文件：

```typescript
// 将这行：
let BASE_URL = AppStorage.Get('BASE_URL') as string || 'http://localhost:9999'

// 改为（连接本地）：
let BASE_URL = AppStorage.Get('BASE_URL') as string || 'http://localhost:9999'

// 或改为（连接远程）：
let BASE_URL = AppStorage.Get('BASE_URL') as string || 'http://42.193.243.96:9999'
```

## 如何确认连接

1. **查看控制台日志**：
   - 现在每次请求都会输出 `[HttpUtils] 后端服务器:` 日志
   - 检查日志中显示的服务器地址是否正确

2. **检查后端是否启动**：
   - 确保后端服务运行在 `localhost:9999`
   - 可以在浏览器访问 `http://localhost:9999` 测试（如果后端有健康检查接口）

3. **查看错误信息**：
   - 如果连接失败，现在会显示更详细的错误信息
   - 包括服务器地址、请求URL、错误详情等

## 常见问题

### Q: 为什么修改了本地后端代码没有效果？
A: 因为前端连接的是远程服务器，需要修改BASE_URL指向本地后端。

### Q: 如何知道当前连接的是哪个服务器？
A: 查看控制台日志，每次请求都会输出 `[HttpUtils] 后端服务器:` 信息。

### Q: 真机无法连接localhost怎么办？
A: 使用电脑的局域网IP地址，例如 `http://192.168.1.100:9999`（替换为你的实际IP）。

### Q: Android模拟器无法连接localhost怎么办？
A: 使用 `http://10.0.2.2:9999` 代替 `localhost`。

## 测试步骤

1. 启动本地后端服务（确保运行在9999端口）
2. 修改BASE_URL指向本地后端
3. 重新运行前端应用
4. 查看控制台日志，确认连接的是本地服务器
5. 测试异常订单处理功能

