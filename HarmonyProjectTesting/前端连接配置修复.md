# 前端连接配置修复

## 后端状态确认 ✅

根据你提供的日志，后端已成功启动：
- ✅ 使用dev环境配置
- ✅ 运行在9999端口
- ✅ 数据库连接正常
- ✅ 应用启动成功

## 问题：前端无法连接后端

错误信息："Couldn't connect to server"

这通常是因为前端配置的地址不正确。

## 解决方案

### 步骤1：确认你使用的设备类型

请告诉我你使用的是：
- [ ] 真机（手机/平板）
- [ ] Android模拟器
- [ ] 本地浏览器调试

### 步骤2：根据设备类型修改配置

#### 情况A：使用真机调试

1. **获取电脑IP地址**
   ```bash
   # Windows
   ipconfig
   # 找到 "IPv4 地址"，例如：192.168.1.100
   ```

2. **修改前端配置**
   - 打开 `SalesNewMaster/entry/src/main/ets/entryability/EntryAbility.ts`
   - 找到第27行，修改为：
     ```typescript
     // 注释掉localhost
     // AppStorage.SetOrCreate('BASE_URL', 'http://localhost:9999')
     
     // 使用电脑IP地址（替换为你的实际IP）
     AppStorage.SetOrCreate('BASE_URL', 'http://192.168.1.100:9999')
     ```

3. **确保手机和电脑在同一WiFi网络**

4. **重新运行前端应用**

#### 情况B：使用Android模拟器

1. **修改前端配置**
   - 打开 `SalesNewMaster/entry/src/main/ets/entryability/EntryAbility.ts`
   - 修改为：
     ```typescript
     // 注释掉localhost
     // AppStorage.SetOrCreate('BASE_URL', 'http://localhost:9999')
     
     // 使用10.0.2.2（Android模拟器专用）
     AppStorage.SetOrCreate('BASE_URL', 'http://10.0.2.2:9999')
     ```

2. **重新运行前端应用**

#### 情况C：使用本地浏览器调试

保持默认配置即可：
```typescript
AppStorage.SetOrCreate('BASE_URL', 'http://localhost:9999')
```

### 步骤3：验证配置

1. **查看前端日志**
   - 应用启动时，应该看到：
     ```
     已设置默认后端地址: http://...
     ```
   - 每次请求时，应该看到：
     ```
     [HttpUtils] 后端服务器: http://...
     [HttpUtils] 完整请求地址: http://.../...
     ```

2. **测试连接**
   - 尝试登录
   - 查看控制台日志，确认请求地址正确

## 快速修复步骤

### 如果是真机调试：

1. **获取电脑IP**
   ```bash
   ipconfig
   ```

2. **修改 EntryAbility.ts**
   ```typescript
   // 第27行，改为你的IP地址
   AppStorage.SetOrCreate('BASE_URL', 'http://你的IP:9999')
   ```

3. **重新运行应用**

### 如果是模拟器：

1. **修改 EntryAbility.ts**
   ```typescript
   // 第27行，改为
   AppStorage.SetOrCreate('BASE_URL', 'http://10.0.2.2:9999')
   ```

2. **重新运行应用**

## 测试后端是否可访问

在浏览器中访问：
```
http://localhost:9999/doc.html
```

如果能看到Swagger API文档页面，说明后端正常。

## 常见问题

### Q: 如何确认电脑IP地址？
A: 
- Windows: 运行 `ipconfig`，找到 "IPv4 地址"
- 确保手机和电脑连接同一个WiFi

### Q: 修改后还是连不上？
A:
1. 确认后端还在运行（不要关闭后端控制台）
2. 确认IP地址正确
3. 检查防火墙是否阻止了9999端口
4. 查看前端日志中的实际请求地址

### Q: 如何查看前端日志？
A:
- 在IDE的控制台查看
- 或使用浏览器的开发者工具（如果是Web应用）

## 下一步

1. 告诉我你使用的设备类型（真机/模拟器/浏览器）
2. 根据设备类型修改配置
3. 重新运行应用
4. 查看日志确认连接地址

